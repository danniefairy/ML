Some of the code are learned from Morvan tutorial, then I figure out the logic and add some notes and improvement.